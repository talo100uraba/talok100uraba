<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TALÃ˜ - Tienda de Ropa</title>
  <link rel="stylesheet" href="estilos_animaciones.css">
</head>
<body style="padding-top: 80px;">

  <header>
    <div id="logo">
      <img src="imagenes/talo.png" alt="Logo TalÃ¸">
      <h1>TALÃ˜</h1>
    </div>
  </header>

  <div class="menu-container">
    <button class="menu-toggle" onclick="toggleMenu()">â˜°</button>
    <nav id="menu" class="menu-links">
      <a href="#camisas">Camisas</a>
      <a href="#shorts">Shorts</a>
      <a href="#gorras">Gorras</a>
      <a href="#lociones">Lociones</a>
      <a href="#promociones">Promociones</a>
    </nav>
  </div>

  <div class="hero">
    <h2>Â¡Explora nuestro catÃ¡logo exclusivo!</h2>
    <p>Encuentra las mejores prendas y accesorios al mejor precio</p>
  </div>

  <div class="secciones">
    <div class="seccion" id="camisas">
      <div class="imagen">
        <a href="camisas.html">
          <img src="imagenes/camisa.jpg" alt="Camisa">
        </a>
      </div>
      <div class="contenido">
        <h3>Camisas</h3>
        <p>Amplia variedad de camisas modernas y clÃ¡sicas para todos los gustos.</p>
      </div>
    </div>

    <div class="seccion" id="shorts">
      <div class="imagen">
        <a href="shorts.html">
          <img src="imagenes/shorts.jpg" alt="Shorts">
        </a>
      </div>
      <div class="contenido">
        <h3>Shorts</h3>
        <p>Ideales para el clima cÃ¡lido, combinan frescura y estilo sin comprometer comodidad.</p>
      </div>
    </div>

    <div class="seccion" id="gorras">
      <div class="imagen">
        <a href="gorras.html">
          <img src="imagenes/gorra.jpg" alt="Gorras">
        </a>
      </div>
      <div class="contenido">
        <h3>Gorras</h3>
        <p>El accesorio perfecto para completar tu look, ya sea casual o deportivo.</p>
      </div>
    </div>

    <div class="seccion" id="lociones">
      <div class="imagen">
        <a href="lociones.html">
          <img src="imagenes/lociones.jpg" alt="Lociones">
        </a>
      </div>
      <div class="contenido">
        <h3>Lociones</h3>
        <p>Fragancias frescas y duraderas para cada ocasiÃ³n.</p>
      </div>
    </div>

    <div class="seccion" id="promociones">
      <div class="imagen">
        <a href="promociones.html">
          <img src="imagenes/descuento.png" alt="Promociones">
        </a>
      </div>
      <div class="contenido">
        <h3>Promociones</h3>
        <p>Ofertas especiales y descuentos Ãºnicos por tiempo limitado.</p>
      </div>
    </div>
  </div>

  <footer>
    <h3>Acerca de Nosotros</h3>
    <p>Somos una marca creada con amor para ti. AquÃ­ encontrarÃ¡s calidad, estilo y precios justos.</p> 
    <p>Â¡Muy pronto nuevos productos y sorpresas!</p>
    <div style="margin-top: 30px;">
      <a href="https://www.instagram.com/talo_100_urbano/" target="_blank">
        <img src="imagenes/instagram.png" alt="Instagram" style="width: 40px; height: 40px; margin-right: 10px;">
      </a>
    </div>
    <div style="margin-top: 20px;">
      <h4>ContÃ¡ctanos</h4>
      <p>ðŸ“ž +57 324 3799852</p>
    </div>
  </footer>

  <div id="visor" onclick="cerrarVisor()">
    <img src="" alt="imagen ampliada" id="imagenGrande">
  </div>

  <script>
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        } else {
          entry.target.classList.remove('visible');
        }
      });
    }, { threshold: 0.2 });
    document.querySelectorAll('.seccion').forEach(seccion => {
      observer.observe(seccion);
    });

    function cerrarVisor() {
      document.getElementById('visor').style.display = 'none';
    }

    function toggleMenu() {
      document.getElementById("menu").classList.toggle("show");
    }
  </script>

  <script>
    const BACKEND_URL = "https://taloadmin-backend.onrender.com";

    async function iniciarSesionAdmin() {
      const username = prompt("ðŸ‘‰ Ingrese Usuario (modo Admin):", "");
      if (!username) return;
      const password = prompt("ðŸ‘‰ Ingrese ContraseÃ±a (modo Admin):", "");
      if (!password) return;
      try {
        const resp = await fetch(`${BACKEND_URL}/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })
        });
        if (resp.status === 200) {
          const { token } = await resp.json();
          localStorage.setItem('admin_jwt', token);
          habilitarModoAdmin();
          alert("âœ”ï¸ SesiÃ³n Admin iniciada.");
        } else {
          const err = await resp.json();
          alert("âŒ " + (err.error || "Credenciales invÃ¡lidas."));
        }
      } catch (e) {
        console.error(e);
        alert("âš ï¸ No se pudo conectar al servidor de autenticaciÃ³n.");
      }
    }

    function tieneTokenValido() {
      const token = localStorage.getItem('admin_jwt');
      if (!token) return false;
      try {
        const payload = JSON.parse(atob(token.split('.')[1]));
        return payload.exp && payload.exp > Math.floor(Date.now() / 1000);
      } catch {
        return false;
      }
    }

    function habilitarModoAdmin() {
      document.body.classList.add("admin-activo");
      document.querySelectorAll("[data-admin='solo']").forEach(el => {
        el.classList.remove("hidden");
      });
      document.querySelectorAll("img").forEach(img => {
        const parent = img.parentElement;
        if (getComputedStyle(parent).position === "static") {
          parent.style.position = "relative";
        }
        const icono = document.createElement("div");
        icono.innerText = "âœŽ";
        Object.assign(icono.style, {
          position: "absolute",
          top: "8px",
          right: "8px",
          background: "rgba(0,0,0,0.6)",
          color: "#fff",
          padding: "2px 5px",
          borderRadius: "4px",
          cursor: "pointer",
          zIndex: "10",
          fontSize: "16px",
          userSelect: "none"
        });
        parent.appendChild(icono);
        const inputFile = document.createElement("input");
        inputFile.type = "file";
        inputFile.accept = "image/*";
        inputFile.style.display = "none";
        parent.appendChild(inputFile);
        icono.addEventListener("click", e => {
          e.stopPropagation();
          inputFile.click();
        });
        inputFile.addEventListener("change", e => {
          const file = e.target.files[0];
          if (!file) return;
          const reader = new FileReader();
          reader.onload = ev => { img.src = ev.target.result; };
          reader.readAsDataURL(file);
          inputFile.value = "";
        });
        img.style.transition = "outline .2s";
        img.addEventListener("mouseenter", () => { img.style.outline = "2px dashed orange"; });
        img.addEventListener("mouseleave", () => { img.style.outline = "none"; });
      });

      if (!document.getElementById("bannerAdmin")) {
        const banner = document.createElement("div");
        banner.id = "bannerAdmin";
        banner.innerText = "ðŸ”’ Modo Admin Activo";
        Object.assign(banner.style, {
          position: "fixed",
          bottom: "10px",
          right: "10px",
          background: "#000",
          color: "#fff",
          padding: "8px 12px",
          zIndex: "2000",
          borderRadius: "4px"
        });
        document.body.appendChild(banner);
      }
    }

    function cerrarSesionAdmin() {
      localStorage.removeItem('admin_jwt');
      sessionStorage.removeItem('modoAdminActivo');
      document.body.classList.remove("admin-activo");
      document.querySelectorAll("[data-admin='solo']").forEach(el => {
        el.classList.add("hidden");
      });
      document.querySelectorAll("h1, h2, h3, h4, p").forEach(el => {
        el.contentEditable = false;
        el.style.cursor = "auto";
      });
      document.querySelectorAll("img").forEach(img => {
        img.style.outline = "none";
        img.replaceWith(img.cloneNode(true));
      });
      const banner = document.getElementById("bannerAdmin");
      if (banner) banner.remove();
      alert("ðŸ”’ SesiÃ³n Admin cerrada.");
    }

    window.addEventListener("DOMContentLoaded", () => {
      const esDesktop = !('ontouchstart' in window);
      const tokenOk = tieneTokenValido();
      const mobileFlag = sessionStorage.getItem("modoAdminActivo") === "true";
      if ((esDesktop && tokenOk) || (!esDesktop && mobileFlag)) {
        habilitarModoAdmin();
      }
      if (esDesktop) {
        window.addEventListener("keydown", async e => {
          if (e.ctrlKey && e.shiftKey && (e.key === 'A' || e.key === 'a')) {
            e.preventDefault();
            await iniciarSesionAdmin();
          }
        });
      }
    });
  </script>

  <button id="btnAdminLogin">Modo Admin</button>
  <script>
    document.getElementById("btnAdminLogin").addEventListener("click", async () => {
      if (!('ontouchstart' in window)) return;
      const usu = prompt("Usuario Admin:");
      const pass = prompt("ContraseÃ±a:");
      if (!usu || !pass) return;
      const hash = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(pass));
      const hashHex = Array.from(new Uint8Array(hash))
        .map(b => b.toString(16).padStart(2, '0'))
        .join('');
      if (usu === "admin" && hashHex === "ef92b778bafe771e89245b89ecbc216e9abf5ed5580c9b8e355d72c7a2cd4d76") {
        sessionStorage.setItem("modoAdminActivo", "true");
        location.reload();
      } else {
        alert("Credenciales incorrectas.");
      }
    });
  </script>

</body>
</html>
